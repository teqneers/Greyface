"use strict";(self.webpackChunk_teqneers_greyface=self.webpackChunk_teqneers_greyface||[]).push([[786],{201:(e,t,n)=>{n.d(t,{A:()=>c});var a=n(6540),r=n(3048),o=n(545),l=n(2100);const c=e=>{let{title:t,children:n}=e;const{t:c}=(0,l.Bd)();return a.createElement(r.A,{fluid:!0,className:"module-container mt-4"},a.createElement(o.mg,null,a.createElement("title",null,c(t))),n)}},1005:(e,t,n)=>{n.d(t,{A:()=>l});var a=n(6540),r=n(5615),o=n(2100);const l=function(e){let{label:t,onClick:n}=e;const{t:l}=(0,o.Bd)();return a.createElement(r.A,{variant:"outline-secondary",className:"m-1",size:"sm",onClick:n},l(t||"button.cancel"))}},6076:(e,t,n)=>{n.d(t,{A:()=>l});var a=n(6540),r=n(5615),o=n(2100);const l=function(e){let{label:t,variant:n,disabled:l=!1,type:c="button",onClick:i}=e;const{t:s}=(0,o.Bd)();return a.createElement(r.A,{variant:n||"outline-primary",size:"sm",className:"m-1",onClick:i||null,disabled:l,type:c},s(t))}},914:(e,t,n)=>{n.d(t,{A:()=>l});var a=n(6540),r=n(5615),o=n(2100);const l=function(e){let{label:t,onClick:n}=e;const{t:l}=(0,o.Bd)();return a.createElement(r.A,{variant:"outline-danger",className:"m-1",size:"sm",onClick:n},l(t||"button.delete"))}},3043:(e,t,n)=>{n.d(t,{A:()=>l});var a=n(6540),r=n(5615),o=n(2100);const l=function(e){let{label:t,variant:n,disabled:l=!1,type:c="submit",onClick:i}=e;const{t:s}=(0,o.Bd)();return a.createElement(r.A,{variant:n||"outline-primary",size:"sm",className:"m-1",onClick:i||null,disabled:l,type:c},s(t))}},8799:(e,t,n)=>{n.d(t,{A:()=>i});var a=n(6540),r=n(2418),o=n(1806),l=n(6828),c=n(2346);const i=e=>{let{date:t,format:n=r.Bp}=e;const i=(0,o.default)(null==t?void 0:t.date);return(0,l.default)(i)||console.log(t,i),a.createElement("span",null,(0,l.default)(i)?(0,c.default)(i,n):"-")}},4821:(e,t,n)=>{n.d(t,{A:()=>i});var a=n(6540),r=n(8032),o=n(2100),l=n(1005),c=n(6076);const i=e=>{let{show:t=!0,title:n="",onCancel:i,onConfirm:s,confirmBtn:u,confirmBtnVariant:d,children:m}=e;const{t:p}=(0,o.Bd)();return a.createElement(r.A,{show:t,onHide:()=>i()},a.createElement(r.A.Header,{closeButton:!0},a.createElement(r.A.Title,null,p(n))),a.createElement(r.A.Body,null,m),a.createElement(r.A.Footer,null,a.createElement(l.A,{onClick:()=>i()}),a.createElement(c.A,{label:u||"button.delete",variant:d||"outline-danger",onClick:()=>s()})))}},3096:(e,t,n)=>{n.d(t,{A:()=>l});var a=n(6540),r=n(8032),o=n(2100);const l=e=>{let{show:t=!0,title:n="",onHide:l,children:c}=e;const{t:i}=(0,o.Bd)();return a.createElement(r.A,{show:t,onHide:()=>l(),backdrop:"static"},a.createElement(r.A.Header,{closeButton:!0},a.createElement(r.A.Title,null,i(n))),c)}},2693:(e,t,n)=>{n.d(t,{A:()=>s});var a=n(6540),r=n(9716),o=n(3048),l=n(9018),c=n(5378),i=n(2100);const s=e=>{let{title:t="",buttons:n,userFilter:s,searchQuery:u="",setSearchQuery:d}=e;const{t:m}=(0,i.Bd)();return a.createElement(r.A,{bg:"light",expand:"lg"},a.createElement(o.A,{fluid:!0},a.createElement(r.A.Brand,null,m(t)),a.createElement(r.A.Toggle,{"aria-controls":"navbarScroll"}),a.createElement(r.A.Collapse,{id:"navbarScroll"},a.createElement(l.A,{className:"me-auto my-2 my-lg-0"},n),a.createElement("div",{className:"d-flex gap-2"},s,a.createElement(c.A.Label,{column:!0},m("placeholder.searchByText")),a.createElement(c.A.Control,{type:"input",name:"search",placeholder:m("placeholder.search"),value:u,onChange:e=>{d(e.target.value)},autoComplete:"off"})))))}},2473:(e,t,n)=>{n.d(t,{A:()=>B});n(4114);var a=n(8168),r=n(4467),o=n(45),l=n(6540),c=n(2431),i=n(4479),s=n(1105),u=n(1069),d=n(5378),m=n(2645),p=n(2885);const h=["canSort","sortDescFirst","isSorted","isSortedDesc","children"],g=e=>{let{canSort:t=!1,sortDescFirst:n,isSorted:r,isSortedDesc:c,children:i}=e,s=(0,o.A)(e,h);return t?l.createElement("div",(0,a.A)({className:"d-flex th",role:"sort-marker"},s),l.createElement("div",{className:"content"},i),r?c?l.createElement("span",{className:"sort-icon active"}," ↓"):l.createElement("span",{className:"sort-icon active"}," ↑"):l.createElement("span",{className:"sort-icon"}," ⇅ ")):l.createElement(l.Fragment,null,i)};var E=n(6942),b=n.n(E),y=n(2100);const A=()=>{const{t:e}=(0,y.Bd)();return l.createElement("div",{style:{height:100,display:"flex",alignItems:"center",justifyContent:"center",textTransform:"uppercase"}},e("placeholder.noData"))},C=["columnCount","data","prepareRow","onRowClick","onRowDoubleClick","rowClassName"];const f=function(e){let{columnCount:t,data:n,prepareRow:r,onRowClick:c,onRowDoubleClick:i,rowClassName:s}=e,u=(0,o.A)(e,C);return l.createElement("tbody",u,n.length>0?n.map(((e,t)=>{r(e);let n=b()("tr",{clickable:!!c||!!i});return s&&(n=s(n,e.original,e.id,t,e)),l.createElement("tr",(0,a.A)({key:e.id},e.getRowProps(),{className:n,onDoubleClick:i?()=>i(e.original,e.id,t,e):null}),e.cells.map((n=>l.createElement("td",(0,a.A)({},n.getCellProps(),{onClick:c&&n.column.rowClick?()=>c(e.original,e.id,t,e):null}),n.render("Cell")))))})):l.createElement("tr",null,l.createElement("td",{colSpan:t},l.createElement(A,null))))};n(2953);const S="...",v=(e,t)=>{const n=t-e+1;return Array.from({length:n},((t,n)=>n+e))};function k(e){return e?(t,n,a)=>{const r=function(e,t,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const r=t.split(","),o=[];return r.map((t=>{const n=t.split(".").reduce(((e,t)=>{var n;return"object"==typeof e&&void 0!==e[t]&&null!==(n=e[t])&&void 0!==n?n:null}),e);o.push(null!=n?n:a)})),o.push(n),o.join("-")}(t,e,n);return String(r||(a?[a.id,n].join("."):n))}:(e,t,n)=>String(n?[n.id,t].join("."):t)}const w=["idColumn","onRowClick","onRowDoubleClick","rowClassName","onStateChange","pageCount"];function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const B=function(e){let{idColumn:t="id",onRowClick:n,onRowDoubleClick:r,rowClassName:h,onStateChange:E,pageCount:b}=e,y=(0,o.A)(e,w);const A=l.useMemo((()=>({width:150})),[]),{getTableProps:C,getTableBodyProps:P,headerGroups:B,prepareRow:j,page:D,canPreviousPage:N,canNextPage:H,pageCount:R,gotoPage:x,nextPage:F,previousPage:W,setPageSize:M,state:z,columns:I}=(0,p.useTable)(O(O({},y),{},{defaultColumn:A,manualSortBy:!0,manualPagination:!0,pageCount:b,getRowId:(0,l.useCallback)(k(t),[t])}),p.useSortBy,p.useColumnOrder,p.usePagination,p.useFlexLayout),{pageIndex:T,pageSize:Q}=z,U=(e=>{let{totalPageCount:t,siblingCount:n=1,currentPage:a}=e;return(0,l.useMemo)((()=>{if(n+5>=t)return v(1,t);const e=Math.max(a-n,1),r=Math.min(a+n,t),o=e>2,l=r<t-2,c=t;if(!o&&l)return[...v(1,3+2*n),S,t];if(o&&!l){const e=v(t-(3+2*n)+1,t);return[1,S,...e]}if(o&&l){const t=v(e,r);return[1,S,...t,S,c]}}),[t,n,a])})({totalPageCount:R,currentPage:T});return(0,m.Ay)((()=>{E&&E(z)}),[E,z]),l.createElement("div",{className:"gf-table"},l.createElement(c.A,(0,a.A)({bordered:!0,size:"sm"},C()),l.createElement("thead",null,B.map((e=>l.createElement("tr",(0,a.A)({key:e.id},e.getHeaderGroupProps()),e.headers.map((e=>l.createElement("th",(0,a.A)({key:e.id},e.getHeaderProps()),l.createElement(g,(0,a.A)({canSort:e.canSort,sortDescFirst:e.sortDescFirst,isSorted:e.isSorted,isSortedDesc:e.isSortedDesc},e.getSortByToggleProps()),e.render("Header"))))))))),l.createElement(f,(0,a.A)({columnCount:I.length,data:D,prepareRow:j},P(),{onRowClick:n,onRowDoubleClick:r,rowClassName:h}))),U.length>0&&l.createElement(i.A,null,l.createElement(s.A,null,l.createElement(u.A,null,l.createElement(u.A.First,{onClick:()=>x(0),disabled:!N}),l.createElement(u.A.Prev,{onClick:()=>W(),disabled:!N}),U.map(((e,t)=>e===S?l.createElement(u.A.Ellipsis,{key:t}):e-1===T?l.createElement(u.A.Item,{key:t,active:!0,onClick:()=>x(e-1)},e):l.createElement(u.A.Item,{key:t,onClick:()=>x(e-1)},e))),l.createElement(u.A.Next,{onClick:()=>F(),disabled:!H}),l.createElement(u.A.Last,{onClick:()=>x(R-1),disabled:!H}))),l.createElement(s.A,{md:4},l.createElement(d.A.Select,{size:"sm",className:"w-25 float-end",value:Q,onChange:e=>{M(Number(e.target.value))}},[10,15,20,25,30,50].map((e=>l.createElement("option",{key:e,value:e},"Show ",e)))))))}},3786:(e,t,n)=>{n.r(t),n.d(t,{default:()=>T});var a=n(4467),r=(n(4114),n(2953),n(6540)),o=n(5942),l=n(6347),c=n(5705),i=n(201),s=n(7839),u=n(6076),d=n(166),m=n(2693),p=(n(3110),n(2735)),h=n(2100),g=n(3096),E=n(8168),b=n(45),y=n(5378),A=n(8032),C=n(4479),f=n(1105),S=n(2664),v=n(8084),k=n(1005),w=n(3043);const P=["onSubmit","submitBtn","onCancel"],O=S.Ik().noUnknown().shape({domain:S.Yj().required().min(1).max(128),source:S.Yj().required().max(128)});const B=function(e){let{onSubmit:t,submitBtn:n,onCancel:a}=e,o=(0,b.A)(e,P);const{t:l}=(0,h.Bd)();return r.createElement(v.l1,(0,E.A)({validateOnBlur:!0,validationSchema:O,onSubmit:e=>{t.mutate(e)}},o),(e=>{let{handleSubmit:o,handleChange:c,values:i,errors:s,isSubmitting:u}=e;return r.createElement(y.A,{noValidate:!0,onSubmit:o},r.createElement(A.A.Body,null,r.createElement(C.A,{className:"mb-3"},r.createElement(y.A.Group,{as:f.A,md:"12",controlId:"validationFormik01"},r.createElement(y.A.Label,null,l("autoWhitelist.domain.domain")),r.createElement(y.A.Control,{type:"text",name:"domain",value:i.domain,onChange:c,isInvalid:!!s.domain}),r.createElement(y.A.Control.Feedback,{type:"invalid"},s.domain)),r.createElement(y.A.Group,{as:f.A,md:"12",controlId:"validationFormik02"},r.createElement(y.A.Label,null,l("autoWhitelist.domain.source")),r.createElement(y.A.Control,{type:"text",name:"source",value:i.source,onChange:c,isInvalid:!!s.source}),r.createElement(y.A.Control.Feedback,{type:"invalid"},s.source)))),r.createElement(A.A.Footer,null,r.createElement(k.A,{onClick:()=>a()}),r.createElement(w.A,{label:n,disabled:u&&!t.isError})))}))},j=e=>{let{onCancel:t,onCreate:n}=e;const[a,l]=(0,r.useState)(null),{t:i}=(0,h.Bd)(),{apiUrl:s}=(0,c.Y)(),u=(0,o.useMutation)((async e=>await fetch("".concat(s,"/awl/domains"),{method:"POST",body:JSON.stringify(e)}).then((function(e){if(!e.ok)throw e;return l(null),e})).then((e=>e.json())).catch((e=>{e.json().then((e=>{l(e.error)}))}))),{onSuccess:async()=>{n()}});return r.createElement(g.A,{title:"autoWhitelist.domain.addHeader",onHide:()=>t()},a&&r.createElement(p.A,{key:"danger",variant:"danger"},a),r.createElement(B,{initialValues:{domain:"",source:""},onSubmit:u,onCancel:t,submitBtn:i("button.save")}))};var D=n(8799),N=n(2473),H=n(2418),R=n(914),x=n(4821);const F=e=>{let{onDelete:t,data:n}=e;const{t:a}=(0,h.Bd)(),{apiUrl:l}=(0,c.Y)(),[i,s]=(0,r.useState)(!1),u=(0,o.useMutation)((e=>fetch("".concat(l,"/awl/domains/delete"),{method:"DELETE",body:JSON.stringify({domain:e.domain,source:e.source})}).then((async e=>{const n=await e.json();if(!e.ok){const t=n&&n.message||e.status;return Promise.reject(t)}t()})).catch((e=>{console.error("There was an error!",e)}))));return r.createElement(r.Fragment,null,r.createElement(R.A,{onClick:()=>s(!0)}),r.createElement(x.A,{show:i,onConfirm:()=>u.mutateAsync(n),onCancel:()=>s(!1),title:"autoWhitelist.domain.deleteHeader"},a("autoWhitelist.domain.deleteMessage")))},W=e=>{let{onUpdate:t,data:n}=e;const{t:a}=(0,h.Bd)(),{apiUrl:l}=(0,c.Y)(),[i,s]=(0,r.useState)(!1),[d,m]=(0,r.useState)(null),E=(0,o.useMutation)((async e=>await fetch("".concat(l,"/awl/domains/edit"),{method:"PUT",body:JSON.stringify({dynamicID:{domain:n.domain,source:n.source},domain:e.domain,source:e.source})}).then((function(e){if(!e.ok)throw e;return m(null),e})).then((e=>e.json())).catch((e=>{e.json().then((e=>{m(e.error)}))}))),{onSuccess:async()=>{t()}});return r.createElement(r.Fragment,null,r.createElement(u.A,{label:"button.edit",onClick:()=>s(!0)}),r.createElement(g.A,{show:i,title:"autoWhitelist.domain.editHeader",onHide:()=>s(!1)},d&&r.createElement(p.A,{key:"danger",variant:"danger"},d),r.createElement(B,{initialValues:{domain:n.domain,source:n.source},onSubmit:E,onCancel:()=>s(!1),submitBtn:a("button.save")})))},M=e=>{let{data:t,refetch:n,isFetching:a,pageCount:o,initialState:l,onStateChange:c}=e;const{t:i}=(0,h.Bd)(),s=(0,r.useMemo)((()=>[{Header:i("autoWhitelist.domain.domain"),id:"domain",accessor:e=>e.domain,canSort:!0,disableResizing:!0},{Header:i("autoWhitelist.domain.source"),id:"source",accessor:e=>e.source,canSort:!0,disableResizing:!0},{Header:i("autoWhitelist.domain.firstSeen"),id:"firstSeen",accessor:e=>r.createElement(D.A,{date:e.firstSeen,format:H.$n}),canSort:!0,disableResizing:!0},{Header:i("autoWhitelist.domain.lastSeen"),id:"lastSeen",accessor:e=>r.createElement(D.A,{date:e.lastSeen,format:H.$n}),canSort:!0,disableResizing:!0},{Header:"",id:"actions",width:100,minWidth:100,maxWidth:100,disableSortBy:!0,disableResizing:!0,Cell:e=>{let{row:{original:t}}=e;return r.createElement(r.Fragment,null,r.createElement(W,{onUpdate:n,data:t}),r.createElement(F,{onDelete:n,data:t}))}}]),[i,n]);return a?r.createElement(d.A,null):r.createElement(N.A,{idColumn:"domain",data:t,pageCount:o,columns:s,disableSortRemove:!0,onStateChange:c,initialState:l})};function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(Object(n),!0).forEach((function(t){(0,a.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const T=()=>{var e;const{apiUrl:t}=(0,c.Y)(),n=(0,l.W6)(),{path:a,url:p}=(0,l.W5)(),{autoWhitelistDomain:h}=(0,s.t0)(),[g,E]=(0,r.useState)(h),[b,y]=(0,r.useState)(null!==(e=h.searchQuery)&&void 0!==e?e:""),A=(0,r.useCallback)((e=>{(0,s.ZC)("autoWhitelistDomain",I(I({},e),{},{searchQuery:b})),E((t=>I(I(I({},t),e),{},{searchQuery:b})))}),[b]);(0,r.useEffect)((()=>{const e=I(I({},g),{},{pageIndex:0,searchQuery:b});(0,s.ZC)("autoWhitelistDomain",e),E(e)}),[b]);const{isLoading:C,isError:f,error:S,data:v,isFetching:k,refetch:w}=(0,o.useQuery)(["awl","domains",g,b],(()=>{let e="".concat(t,"/awl/domains?start=").concat(g.pageIndex,"&max=").concat(g.pageSize,"&query=").concat(b);return g.sortBy[0]&&(e+="&sortBy=".concat(g.sortBy[0].id,"&desc=").concat(g.sortBy[0].desc?1:0)),fetch(e).then((e=>e.json()))}),{keepPreviousData:!0});return C?r.createElement(d.A,null):r.createElement(i.A,{title:"autoWhitelist.domain.header"},r.createElement(m.A,{title:"autoWhitelist.domain.header",buttons:r.createElement(u.A,{label:"button.addDomain",onClick:()=>n.push("".concat(p,"/add"))}),searchQuery:b,setSearchQuery:y}),f?r.createElement("div",null,"Error: ",S):r.createElement(M,{data:v.results,refetch:w,pageCount:Math.ceil(v.count/g.pageSize),isFetching:k||C,initialState:g,onStateChange:A}),r.createElement(l.qh,{path:"".concat(a,"/add")},r.createElement(j,{onCancel:()=>n.push(p),onCreate:()=>{n.push(p),w()}})))}},2418:(e,t,n)=>{n.d(t,{$n:()=>o,Bp:()=>r,DX:()=>a});const a="dd.MM.yyyy",r="dd.MM.yyyy HH:mm",o="dd.MM.yyyy HH:mm:ss"}}]);