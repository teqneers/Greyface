"use strict";(self.webpackChunk_teqneers_greyface=self.webpackChunk_teqneers_greyface||[]).push([[990],{201:(e,t,n)=>{n.d(t,{A:()=>c});var r=n(6540),a=n(3048),l=n(545),o=n(2100);const c=e=>{let{title:t,children:n}=e;const{t:c}=(0,o.Bd)();return r.createElement(a.A,{fluid:!0,className:"module-container mt-4"},r.createElement(l.mg,null,r.createElement("title",null,c(t))),n)}},1005:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(6540),a=n(5615),l=n(2100);const o=function(e){let{label:t,onClick:n}=e;const{t:o}=(0,l.Bd)();return r.createElement(a.A,{variant:"outline-secondary",className:"m-1",size:"sm",onClick:n},o(t||"button.cancel"))}},6076:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(6540),a=n(5615),l=n(2100);const o=function(e){let{label:t,variant:n,disabled:o=!1,type:c="button",onClick:s}=e;const{t:i}=(0,l.Bd)();return r.createElement(a.A,{variant:n||"outline-primary",size:"sm",className:"m-1",onClick:s||null,disabled:o,type:c},i(t))}},914:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(6540),a=n(5615),l=n(2100);const o=function(e){let{label:t,onClick:n}=e;const{t:o}=(0,l.Bd)();return r.createElement(a.A,{variant:"outline-danger",className:"m-1",size:"sm",onClick:n},o(t||"button.delete"))}},8799:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(6540),a=n(2418),l=n(1806),o=n(6828),c=n(2346);const s=e=>{let{date:t,format:n=a.Bp}=e;const s=(0,l.default)(null==t?void 0:t.date);return(0,o.default)(s)||console.log(t,s),r.createElement("span",null,(0,o.default)(s)?(0,c.default)(s,n):"-")}},4821:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(6540),a=n(8032),l=n(2100),o=n(1005),c=n(6076);const s=e=>{let{show:t=!0,title:n="",onCancel:s,onConfirm:i,confirmBtn:u,confirmBtnVariant:m,children:d}=e;const{t:g}=(0,l.Bd)();return r.createElement(a.A,{show:t,onHide:()=>s()},r.createElement(a.A.Header,{closeButton:!0},r.createElement(a.A.Title,null,g(n))),r.createElement(a.A.Body,null,d),r.createElement(a.A.Footer,null,r.createElement(o.A,{onClick:()=>s()}),r.createElement(c.A,{label:u||"button.delete",variant:m||"outline-danger",onClick:()=>i()})))}},2693:(e,t,n)=>{n.d(t,{A:()=>i});var r=n(6540),a=n(9716),l=n(3048),o=n(9018),c=n(5378),s=n(2100);const i=e=>{let{title:t="",buttons:n,userFilter:i,searchQuery:u="",setSearchQuery:m}=e;const{t:d}=(0,s.Bd)();return r.createElement(a.A,{bg:"light",expand:"lg"},r.createElement(l.A,{fluid:!0},r.createElement(a.A.Brand,null,d(t)),r.createElement(a.A.Toggle,{"aria-controls":"navbarScroll"}),r.createElement(a.A.Collapse,{id:"navbarScroll"},r.createElement(o.A,{className:"me-auto my-2 my-lg-0"},n),r.createElement("div",{className:"d-flex gap-2"},i,r.createElement(c.A.Label,{column:!0},d("placeholder.searchByText")),r.createElement(c.A.Control,{type:"input",name:"search",placeholder:d("placeholder.search"),value:u,onChange:e=>{m(e.target.value)},autoComplete:"off"})))))}},2473:(e,t,n)=>{n.d(t,{A:()=>D});n(4114);var r=n(8168),a=n(4467),l=n(45),o=n(6540),c=n(2431),s=n(4479),i=n(1105),u=n(1069),m=n(5378),d=n(2645),g=n(2885);const p=["canSort","sortDescFirst","isSorted","isSortedDesc","children"],h=e=>{let{canSort:t=!1,sortDescFirst:n,isSorted:a,isSortedDesc:c,children:s}=e,i=(0,l.A)(e,p);return t?o.createElement("div",(0,r.A)({className:"d-flex th",role:"sort-marker"},i),o.createElement("div",{className:"content"},s),a?c?o.createElement("span",{className:"sort-icon active"}," ↓"):o.createElement("span",{className:"sort-icon active"}," ↑"):o.createElement("span",{className:"sort-icon"}," ⇅ ")):o.createElement(o.Fragment,null,s)};var y=n(6942),E=n.n(y),f=n(2100);const b=()=>{const{t:e}=(0,f.Bd)();return o.createElement("div",{style:{height:100,display:"flex",alignItems:"center",justifyContent:"center",textTransform:"uppercase"}},e("placeholder.noData"))},A=["columnCount","data","prepareRow","onRowClick","onRowDoubleClick","rowClassName"];const C=function(e){let{columnCount:t,data:n,prepareRow:a,onRowClick:c,onRowDoubleClick:s,rowClassName:i}=e,u=(0,l.A)(e,A);return o.createElement("tbody",u,n.length>0?n.map(((e,t)=>{a(e);let n=E()("tr",{clickable:!!c||!!s});return i&&(n=i(n,e.original,e.id,t,e)),o.createElement("tr",(0,r.A)({key:e.id},e.getRowProps(),{className:n,onDoubleClick:s?()=>s(e.original,e.id,t,e):null}),e.cells.map((n=>o.createElement("td",(0,r.A)({},n.getCellProps(),{onClick:c&&n.column.rowClick?()=>c(e.original,e.id,t,e):null}),n.render("Cell")))))})):o.createElement("tr",null,o.createElement("td",{colSpan:t},o.createElement(b,null))))};n(2953);const S="...",v=(e,t)=>{const n=t-e+1;return Array.from({length:n},((t,n)=>n+e))};function w(e){return e?(t,n,r)=>{const a=function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const a=t.split(","),l=[];return a.map((t=>{const n=t.split(".").reduce(((e,t)=>{var n;return"object"==typeof e&&void 0!==e[t]&&null!==(n=e[t])&&void 0!==n?n:null}),e);l.push(null!=n?n:r)})),l.push(n),l.join("-")}(t,e,n);return String(a||(r?[r.id,n].join("."):n))}:(e,t,n)=>String(n?[n.id,t].join("."):t)}const k=["idColumn","onRowClick","onRowDoubleClick","rowClassName","onStateChange","pageCount"];function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){(0,a.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const D=function(e){let{idColumn:t="id",onRowClick:n,onRowDoubleClick:a,rowClassName:p,onStateChange:y,pageCount:E}=e,f=(0,l.A)(e,k);const b=o.useMemo((()=>({width:150})),[]),{getTableProps:A,getTableBodyProps:P,headerGroups:D,prepareRow:j,page:B,canPreviousPage:N,canNextPage:R,pageCount:x,gotoPage:F,nextPage:M,previousPage:z,setPageSize:H,state:T,columns:W}=(0,g.useTable)(O(O({},f),{},{defaultColumn:b,manualSortBy:!0,manualPagination:!0,pageCount:E,getRowId:(0,o.useCallback)(w(t),[t])}),g.useSortBy,g.useColumnOrder,g.usePagination,g.useFlexLayout),{pageIndex:L,pageSize:Q}=T,U=(e=>{let{totalPageCount:t,siblingCount:n=1,currentPage:r}=e;return(0,o.useMemo)((()=>{if(n+5>=t)return v(1,t);const e=Math.max(r-n,1),a=Math.min(r+n,t),l=e>2,o=a<t-2,c=t;if(!l&&o)return[...v(1,3+2*n),S,t];if(l&&!o){const e=v(t-(3+2*n)+1,t);return[1,S,...e]}if(l&&o){const t=v(e,a);return[1,S,...t,S,c]}}),[t,n,r])})({totalPageCount:x,currentPage:L});return(0,d.Ay)((()=>{y&&y(T)}),[y,T]),o.createElement("div",{className:"gf-table"},o.createElement(c.A,(0,r.A)({bordered:!0,size:"sm"},A()),o.createElement("thead",null,D.map((e=>o.createElement("tr",(0,r.A)({key:e.id},e.getHeaderGroupProps()),e.headers.map((e=>o.createElement("th",(0,r.A)({key:e.id},e.getHeaderProps()),o.createElement(h,(0,r.A)({canSort:e.canSort,sortDescFirst:e.sortDescFirst,isSorted:e.isSorted,isSortedDesc:e.isSortedDesc},e.getSortByToggleProps()),e.render("Header"))))))))),o.createElement(C,(0,r.A)({columnCount:W.length,data:B,prepareRow:j},P(),{onRowClick:n,onRowDoubleClick:a,rowClassName:p}))),U.length>0&&o.createElement(s.A,null,o.createElement(i.A,null,o.createElement(u.A,null,o.createElement(u.A.First,{onClick:()=>F(0),disabled:!N}),o.createElement(u.A.Prev,{onClick:()=>z(),disabled:!N}),U.map(((e,t)=>e===S?o.createElement(u.A.Ellipsis,{key:t}):e-1===L?o.createElement(u.A.Item,{key:t,active:!0,onClick:()=>F(e-1)},e):o.createElement(u.A.Item,{key:t,onClick:()=>F(e-1)},e))),o.createElement(u.A.Next,{onClick:()=>M(),disabled:!R}),o.createElement(u.A.Last,{onClick:()=>F(x-1),disabled:!R}))),o.createElement(i.A,{md:4},o.createElement(m.A.Select,{size:"sm",className:"w-25 float-end",value:Q,onChange:e=>{H(Number(e.target.value))}},[10,15,20,25,30,50].map((e=>o.createElement("option",{key:e,value:e},"Show ",e)))))))}},8178:(e,t,n)=>{n.d(t,{A:()=>i});var r=n(6540),a=n(5378),l=n(2100),o=n(5942),c=n(5705),s=n(166);const i=e=>{let{user:t,setUser:n,filterFor:i="userAlias"}=e;const{t:u}=(0,l.Bd)(),{apiUrl:m}=(0,c.Y)(),{data:d,isLoading:g}=(0,o.useQuery)(["users"],(()=>fetch("".concat(m,"/users")).then((e=>e.json()))),{keepPreviousData:!0});return g?r.createElement(s.A,null):r.createElement(r.Fragment,null,r.createElement(a.A.Label,{column:!0},u("placeholder.user")),r.createElement(a.A.Select,{size:"sm",value:t,onChange:e=>n(e.target.value)},r.createElement("option",{value:""},u("placeholder.showAll")),"greylist"===i&&r.createElement("option",{value:"show_unassigned"},u("placeholder.showUnassigned")),d&&d.results&&d.results.map((e=>r.createElement("option",{key:e.id,value:e.id},e.username)))))}},6990:(e,t,n)=>{n.r(t),n.d(t,{default:()=>N});var r=n(4467),a=(n(4114),n(2953),n(6540)),l=n(5942),o=n(5705),c=n(201),s=n(7839),i=n(9907),u=n(166),m=n(2693),d=n(8178),g=(n(3110),n(2346)),p=n(5378),h=n(1105),y=n(2100),E=n(9386),f=n.n(E),b=n(914),A=n(4821),C=n(2418);const S=e=>{let{onDelete:t}=e;const{t:n}=(0,y.Bd)(),{apiUrl:r}=(0,o.Y)(),[c,s]=(0,a.useState)(new Date),[i,u]=(0,a.useState)(!1),m=(0,l.useMutation)((e=>fetch("".concat(r,"/greylist/delete-to-date"),{method:"DELETE",body:JSON.stringify(e)}).then((async e=>{const n=await e.json();if(!e.ok){const t=n&&n.message||e.status;return Promise.reject(t)}u(!1),t()})).catch((e=>{console.error("There was an error!",e)}))));return a.createElement(a.Fragment,null,a.createElement(b.A,{onClick:()=>u(!0),label:"button.deleteByDate"}),a.createElement(A.A,{show:i,onConfirm:()=>m.mutateAsync({date:(0,g.default)(c,C.DX)}),onCancel:()=>u(!1),title:"greylist.deleteByDateHeader"},n("greylist.deleteByDateMessage"),a.createElement(p.A.Group,{as:h.A,md:"12",className:"mt-2"},a.createElement(f(),{selected:c,onChange:e=>s(e),className:"form-control",dateFormat:C.DX}))))};var v=n(2473),w=n(8799);const k=e=>{let{onDelete:t,data:n}=e;const{t:r}=(0,y.Bd)(),{apiUrl:c}=(0,o.Y)(),s=!1,[i,u]=(0,a.useState)(!1),m=(0,l.useMutation)((e=>fetch("".concat(c,"/greylist/delete"),{method:"DELETE",body:JSON.stringify({name:e.connect.name,domain:e.connect.domain,source:e.connect.source,rcpt:e.connect.rcpt})}).then((async e=>{const n=await e.json();if(!e.ok){const t=n&&n.message||e.status;return Promise.reject(t)}t()})).catch((e=>{console.error("There was an error!",e)}))));return a.createElement(a.Fragment,null,s,a.createElement(b.A,{onClick:()=>m.mutateAsync(n)}))};var P=n(6076);const O=e=>{let{onMove:t,data:n}=e;const{t:r}=(0,y.Bd)(),{apiUrl:c}=(0,o.Y)(),s=!1,[i,u]=(0,a.useState)(!1),m=(0,l.useMutation)((e=>fetch("".concat(c,"/greylist/toWhiteList"),{method:"POST",body:JSON.stringify({name:e.connect.name,domain:e.connect.domain,source:e.connect.source,rcpt:e.connect.rcpt})}).then((async e=>{const n=await e.json();if(!e.ok){const t=n&&n.message||e.status;return Promise.reject(t)}t()})).catch((e=>{console.error("There was an error!",e)}))));return a.createElement(a.Fragment,null,s,a.createElement(P.A,{label:"button.moveToWhitelist",onClick:()=>m.mutateAsync(n)}))},D=e=>{let{data:t,refetch:n,isFetching:r,pageCount:l,initialState:o,onStateChange:c}=e;const{t:s}=(0,y.Bd)(),{isAdministrator:m}=(0,i.S)(),d=(0,a.useMemo)((()=>{const e=[{Header:s("greylist.sender"),id:"name",minWidth:300,maxWidth:500,accessor:e=>e.connect.name,canSort:!0,disableResizing:!0},{Header:s("greylist.domain"),id:"domain",width:160,minWidth:150,maxWidth:200,accessor:e=>e.connect.domain,canSort:!0,disableResizing:!0},{Header:s("greylist.source"),id:"source",width:130,minWidth:130,maxWidth:150,accessor:e=>e.connect.source,canSort:!0,disableResizing:!0},{Header:s("greylist.recipient"),id:"rcpt",width:180,minWidth:180,maxWidth:250,accessor:e=>e.connect.rcpt,canSort:!0,disableResizing:!0},{Header:s("greylist.firstSeen"),id:"firstSeen",accessor:e=>a.createElement(w.A,{date:e.connect.firstSeen,format:C.$n}),canSort:!0,disableResizing:!0}];return m()&&e.push({Header:s("greylist.username"),id:"username",width:100,minWidth:100,maxWidth:150,accessor:e=>e.username,canSort:!0,disableResizing:!0}),e.push({Header:"",id:"actions",width:220,minWidth:220,maxWidth:220,disableSortBy:!0,disableResizing:!0,Cell:e=>{let{row:{original:t}}=e;return a.createElement(a.Fragment,null,a.createElement(O,{onMove:n,data:t}),a.createElement(k,{onDelete:n,data:t}))}}),e}),[s,n,m]);return r?a.createElement(u.A,null):a.createElement(v.A,{idColumn:"connect.domain,username",data:t,pageCount:l,columns:d,disableSortRemove:!0,onStateChange:c,initialState:o})};function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const N=()=>{var e,t;const{apiUrl:n}=(0,o.Y)(),{isAdministrator:r}=(0,i.S)(),{greyList:g}=(0,s.t0)(),[p,h]=(0,a.useState)(g),[y,E]=(0,a.useState)(null!==(e=g.searchQuery)&&void 0!==e?e:""),[f,b]=(0,a.useState)(null!==(t=g.user)&&void 0!==t?t:""),A=(0,a.useCallback)((e=>{(0,s.ZC)("greyList",B(B({},e),{},{searchQuery:y,user:f})),h((t=>B(B(B({},t),e),{},{searchQuery:y})))}),[y,f]);(0,a.useEffect)((()=>{const e=B(B({},p),{},{pageIndex:0,searchQuery:y,user:f});(0,s.ZC)("greyList",e),h(e)}),[y,f]);const{isLoading:C,isError:v,error:w,data:k,isFetching:P,refetch:O}=(0,l.useQuery)(["greylist",p,y,f],(()=>{let e="".concat(n,"/greylist?start=").concat(p.pageIndex,"&max=").concat(p.pageSize,"&query=").concat(y);return p.sortBy[0]&&(e+="&sortBy=".concat(p.sortBy[0].id,"&desc=").concat(p.sortBy[0].desc?1:0)),f&&(e+="&user=".concat(f)),fetch(e).then((e=>e.json()))}),{keepPreviousData:!0});return C?a.createElement(u.A,null):a.createElement(c.A,{title:"greylist.header"},r()&&a.createElement(m.A,{title:"greylist.header",buttons:a.createElement(S,{onDelete:O}),userFilter:a.createElement(d.A,{user:f,setUser:b,filterFor:"greylist"}),searchQuery:y,setSearchQuery:E}),!r()&&a.createElement(m.A,{title:"greylist.header",setSearchQuery:E}),v?a.createElement("div",null,"Error: ",w):a.createElement(D,{data:k.results,refetch:O,pageCount:Math.ceil(k.count/p.pageSize),isFetching:P||C,initialState:p,onStateChange:A}))}},2418:(e,t,n)=>{n.d(t,{$n:()=>l,Bp:()=>a,DX:()=>r});const r="dd.MM.yyyy",a="dd.MM.yyyy HH:mm",l="dd.MM.yyyy HH:mm:ss"}}]);